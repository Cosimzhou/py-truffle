# -*- coding: UTF-8 -*-

init_tuple=((13,2),(1,2),(4,2),(10,2),(15,-2),(16,-2),(17,-2),(18,3),(24,-2),(25,3),(28,2))
init_tuple=((12,2),(3,-3),(24,-2),(26,3),(33,2))

Digests =(
( 6, 8,"1111C3OXQ"),
(10,14,"3121D569O0SW"),
(10,14,"1712CF012EHITU39"),
( 8,12,"1432CB09GQSUX3I"),
( 7,10,"0621C4BEFJQ1U7"),
(15,20,"2310C253FJQ"),
(16,23,"3331DABF3KO06IX"),
(15,20,"0442DFGHO14ASIP"),
(18,24,"2341EKL7GJ8ASU0"),
(18,24,"1512CE1BFINR38"),
(18,24,"1313DF26PI39W"),
(19,25,"1322CB9LQSX1I"),
(22,28,"3212E01A5KI2R"),
(24,30,"1352C819TAPRVX2L"),
(16,24,"1531F836HSTALV0"),
(18,24,"3340C4BI89PJLWY"),
(24,30,"1641EK567GHJ02SU8"),
(22,28,"2521CBJ029GRKY3"),
(24,30,"0642C05EFGJ1379QU"),
(21,27,"0732C35AEHMOIPV06"),
(19,25,"2322C5I49G02JV"),
(18,24,"2170C23G04AIKVX"),
(20,26,"1512E457HJKX0R"),
(20,26,"0521C348FIPR0"),
(27,36,"0531D4CGJQKRX6"),
(28,36,"0711C045EFGRS7"),
(28,36,"0611C38BFIN4P"),
(28,36,"2360CFI58H09JSVX"),
(30,40,"1622CF045EGHSW17"),
(32,42,"2161C2H34APRVXJ"),
(32,42,"0651C08FKPT1IMRW9"),
(34,44,"1641D36HIJKT04ALU"),
(34,44,"1622C3458KOP6R0W"),
(34,44,"1830C41589HKOR2IV"),
(36,50,"1560DN36FIK04ARUW"),
(34,48,"0812C045EFGHRS17"),
(36,50,"0770C058FIJS139MQUW"),
(36,54,"3270E1ABKL248ISVX"),
(36,54,"1621CH38AFMO4IP"),
(38,56,"3370E1AB0KL248ISVX"),
(38,56,"1622C504EFGRIS17"),
(38,56,"3251E457KL8MOVX0"),
(38,56,"1631CH38FGOSAIWP"),
(40,58,"0731C045EFGRISY7"),
(48,64,"2432CAB0EFRISV17"),
(48,64,"1371DH29C6JLOQUW3"),
(50,70,"1622CG38FHIT4APV"),
(50,70,"1641EL256GHS09IUO"),
(21,35,"0551C3EFOS0IMQW6"),
(23,38,"2351E1A0BK248IRU"),
(21,35,"1631F0378HKT1AOU"),
(22,36,"0840C14589LQT2JMX"),
(21,35,"1631E4257HLO0ISV"),
(21,35,"1541EB2467L0SUWI"),
(22,36,"1451DF26BT39MVXO"),
(21,35,"1721D0125FGRS39U"),
(25,41,"0841F45678HILJSUW0"),
(23,38,"2341C2HGIJAKUWQ"),
(21,35,"2441C2B3AIR46JLU"),
(21,35,"2351F8B4LO16IPSV"),
(23,38,"1461D05FHK138IVYR"),
(21,35,"1732C20ABFIPTJMW3Q"),
(23,38,"2431E1A56HKIRU2"),
(23,38,"3460FCDM38HT46KQUW"),
(21,35,"2332C8H0MOAVY2P"),
(23,38,"2431C5G089L13JO"),
(23,38,"2440D9G256P03QW"),
(24,40,"3350E1AB0KR24ISU"),
(23,38,"1612C358KOSTV0L"),
(24,40,"1343CG0FNOQUW38I"),
(21,35,"0930C0158FGHKR29V"),
(23,38,"1640C23ABFMO4QVX"),
(21,35,"1541CE0ABNR148LU"),
(22,36,"3251C4IJ9E02LWY6"),
(23,38,"1541C40BENR28ILO"),
(21,35,"0661C3458FOIMPRVX0"),
(22,36,"2290C5I8F029JMPRWY"),
(21,35,"1660D9456KOP02IRWY"),
(24,40,"2450E4527KL0ISVX"),
(24,40,"1441D36KPS7ILW0"),
(21,35,"1730CJ048BGIR1KY"),
(23,38,"0660F5EHILQ0268SY"),
(22,36,"0641D269HKPAILS3"),
(22,36,"3151F2BCL04JPSV"),
(22,36,"2631E4L567HIQJSY0"),
(21,35,"2350E1ABLO3ISVX"),
(21,35,"1442DA59HQ7IKR2X"),
(21,35,"1431DH2FJM03Q9"),
(25,41,"2342C2HGIJAKUW3Q"),
(22,36,"1540C5149GL2IUW"),
(22,36,"1441CH03FQ47RUI"),
(22,36,"2432CHJ09AE137QX"),
(21,35,"2241C2N3I6AUWJ"),
(21,35,"1621DA36FHOQ4RI"),
(22,36,"0732E126ABDTKMU3O"),
(23,38,"3251E01ABK248IRU"),
(21,35,"1531CF08BMN24WO"),
(21,35,"0651D34FKOTIMRVX0"),
(21,35,"1541C3BENOQ14IY6"),
(24,40,"1550F13BMNQ4IKOX"),
(24,40,"0831F0378CHKT1ARU"),
(22,36,"1441C503EQ17IUR"),
(23,38,"1641C3048BGN1IKWO"),
(21,35,"4131E1ABIL3JSV"),
(21,35,"1223DACQ6O0JX"),
(23,38,"1540E427KOR0ISV"),
(25,41,"2242E0A3Q14UXIR"),
(22,36,"1650CB09AEIR7LPUY"),
(22,36,"1620F50378KL1S"),
(21,35,"2351EBD2AC36QSUK"),
(21,35,"1512CA8HIQRY2J"),
(23,38,"2450D3A6BIQ47KRU"),
(23,38,"1461E45DHK6LOSUW0"),
(23,38,"2450D6H19GQ24JRU"),
(21,35,"1333C4EHTLOQ06U"),
(25,41,"1421C38GISAWP"),
(22,36,"1523C40BEIT7M1PU"),
(23,38,"1460C958IS13JMUW"),
(21,35,"0660C38FIQT46JMRX"),
(24,40,"0751E267GHKL0ISVX9"),
(21,35,"0731C048BKNR1ILU"),
(21,35,"1541C958KOT13IMV"),
(24,40,"1551CH03EGP17AIWQ"),
(25,41,"2323C4FBETMV17O"),
(25,41,"2540D0A3BFKNIRVX"),
(24,40,"2132E1AKIVX2R"),
(24,40,"0651C35EFOS0IMQW6"),
(23,38,"1532CA0589J13KQU"),
(24,40,"1632D926IMNPAJQ3W"),
(23,38,"2530E4K5CDHP68Y"),
(22,36,"2380D09HKT137AIRUW"),
(21,35,"1640CB09AEIR7LPU"),
(25,41,"0622C589HIRSU1J"),
(22,36,"1451CB49EO02ILP6"),
(24,40,"1342C90ES7MUW1P"),
(24,40,"1442CG0BFNOQUW8I"),
(21,35,"1730E0257GHLS39O"),
(21,35,"3222E01A5KIR2U"),
(21,35,"1520C429EIL0P"),
(22,36,"1541CF45EIT02MP7"),
(23,38,"2431E6ABNQR0UYJ"),
(25,41,"1551C38HKOTALRVX0"),
(22,36,"0722D269HIJTAK3Q"),
(24,40,"0632C09AELT7IMOV"),
(25,41,"2360E1ABKL38ISVX"),
(21,35,"1451EB37GQ14RUYI"),
(22,36,"2241D0ABQ13UXI"),
(21,35,"0551C358HI6QSUW0"),
(21,35,"2712C4L05EHOPQY17"),
(23,38,"2221FBE367IR"),
(24,40,"3241E16BLQ24JSX"),
(21,35,"2350C2B3IS04JLU"),
(24,40,"1342C90ET7MUW1P"),
(23,38,"1432C4BEFTMUW7O"),
(21,35,"2232CHI9Q02AJX"),
(21,35,"1640D0125FQR39SU"),
(21,35,"1542CH01EIS248LPU"),
(24,40,"1422C4BENR1L7O"),
(25,41,"1740EB67GIJQR9KSU"),
(22,36,"2351EAB3DQ14KUX6"),
(22,36,"1531EH37CGQARXJ"),
(23,38,"0641C02EHMT4AIUO"),
(23,38,"1540C25FHOR39PV"),
(22,36,"3512C34I5EHPQY06"),
(21,35,"2440D0K5AHR7LSU"),
(24,40,"2232C5IEFMPR0V"),
(21,35,"2522DHJ26FGIWY9Q"),
(21,35,"1441CF05EH13IS7"),
(22,36,"1631C9048HKP2IRW"),
(21,35,"1451CF2EOT69MPV3"),
(25,41,"0721E45CDGHK6R0"),
(24,40,"2251C8HIS1ALUWP"),
(25,41,"1560EK037HL1AISUX"),
(21,35,"2550F1MEHORT48AIV"),
(24,40,"2540E4K5CDHP068Y"),
(22,36,"2332CBF0GQ8SU1I"),
(24,40,"1411C5089LS1"),
(22,36,"2560FDM38CHT46KQUW"),
(21,35,"1432C3048G1IKOV"),
(21,35,"2520C2B3AFIM4Q"),
(25,41,"1541CB12AER4LUYO"),
(23,38,"2441C5A089J13KUQ"),
(22,36,"2351D0A1BQ248RUI"),
(24,40,"1541F0378HT1AOUI"),
(23,38,"1551E1BKNOR24IVY8"),
(21,35,"2521C251FIMR9PU"),
(22,36,"3222E01A5KIU2R"),
(25,41,"1451F5148L2JMUWO"),
(21,35,"0651D259CHO36QSYJ"),
(22,36,"1423C835HSIL0OU"),
(22,36,"3250D05A1K3IRUW"),
(22,36,"2451C450IJR7KMSU1"),
(25,41,"1621E027BGNS39O"),
(21,35,"1650F138CHQR4JLSU"),
(23,38,"0651C3458HI6QSUW0"),
(21,35,"0640F023EHT4AOQ"),
(22,36,"1521DG29HJTAQ3"),
(24,40,"2440D0A3FKN14IR"),
(24,40,"2330C2B9IRJLP"),
(22,36,"1641C80345IR1PUYL"),
(22,36,"2521DGH029CJAQ3"),
(23,38,"2521D0N12GKS3IU"),
(21,35,"1641C40BEFJT8MVXQ"),
(21,35,"1503E435CHK06R"),
(21,35,"1550CA03BNQ14IKR"),
(21,35,"2530C8B19ALOIPV"),
(24,40,"0831C3458HKOPLWY0"),
(22,36,"2431ELN26GS03IU"),
(24,40,"2323C5F04E8M1OV"),
(21,35,"0422D4GKP0R6W"),
(21,35,"1371DA0CP137QSWYJ"),
(21,35,"1431CF0AET8IMO"),
(21,35,"2531C2B03AMR4PYJ"),
(22,36,"2530D5K14FGR2IY"),
(22,36,"1342C3GIQ6AJU0R"),
(22,36,"2322E1A0LOIS2V"),
(24,40,"2451D0A15HK38IUWR"),
(24,40,"2423E1B0GLOIS28V"),
(21,35,"2242F5E7R02IS8U"),
(22,36,"2540E7A3BCNQ4KRU"),
(21,35,"1470EB27AR0JLPSUY"),
(21,35,"3241F26B7R4JLSU"),
(25,41,"2350C259LO0IPVX"),
(23,38,"3160DBCKR168LSU"),
(25,41,"2521E0A37HLQ4SI"),
(21,35,"1631DA015CHQJUX2"),
(22,36,"1424CB0AERIL37OU"),
(21,35,"2350E0ABKR13ISU"),
(22,36,"2241D0A1K24IUR"),
(24,40,"1542C40BEFT8MUW1O"),
(21,35,"0541C089GP13IKQ"),
(24,40,"0741D26FGKNP0IRW9"),
(21,35,"2331C5E0AR7SVL"),
(24,40,"1432DG36HQ0AOJX"),
(25,41,"2451FBC38MR46PUYJ"),
(21,35,"2332E0A5KR8IS2U"),
(21,35,"1341E4DKR06LOU"),
(22,36,"1613C21HILMTP39U"),
(24,40,"1512CF045EGS17"),
(22,36,"2341F8B6LO9IPSV"),
(23,38,"1641CH01FGIQJRUX9"),
(21,35,"2451E1B0CQR248OYJ"),
(23,38,"0822E57GHKLOSIV08"),
(22,36,"2450D5CAJQR6KMSU"),
(21,35,"0821E037CGHQTARJ"),
(22,36,"3270C45JEF0268MWY"),
(21,35,"1541CH03EGJ17AYQ"),
(21,35,"0471C2EFT04IMOQV9"),
(21,35,"2522D345CHKO6R0V"),
(21,35,"1631C80345IR1PUL"),
(21,35,"2370EADCLQ1368SUX"),
(23,38,"1532FH4CDEP0WY6Q"),
(22,36,"2440D0A3FKN4IRU"),
(21,35,"2360E0BDGR279KSU"),
(25,41,"2441C5G089L13JUO"),
(21,35,"1451CG08BN249VXO"),
(21,35,"1731CI129EHMT3APV"),
(23,38,"1631DH29ACJK6RV3"),
(21,35,"2361D5A0CP137QSXJ"),
(21,35,"2331C2N03IAUWJ"),
(23,38,"1632E46BIKNR02L7U"),
(21,35,"0631C45EHPQISY6"),
(21,35,"1623DN26FIMPJQ39W"),
(22,36,"2450D0K9HJT27ALU"),
(24,40,"0760C14589HK2ILOVY"),
(25,41,"2441D0A1BFQ38RXI"),
(21,35,"1351C29HR03AJLU"),
(23,38,"2331EGN37Q4AXJ"),
(22,36,"0922D0159ACHJQUY2K"),
(24,40,"1721D42356FJK0RW"),
(21,35,"2531E0L57AHQSUYI"),
(21,35,"3260C45JEF068MWY"),
(21,35,"2151E1AK248IRU"),
(21,35,"1481F1BENO24ILPRWY8"),
(22,36,"1233DK5F68M1RX"),
(23,38,"2351FBC38R146UYJ"),
(21,35,"2512D345COPQR0X"),
(23,38,"1551CE459HO02SVY6"),
(22,36,"2540C5I149GL2JVX"),
(24,40,"2540F0B38MPR4IKY"),
(22,36,"1641E703BKST4OUWL"),
(22,36,"1370C98IS13JMPUW"),
(24,40,"1641EH037CGQ4ARXJ"),
(22,36,"0831C15AEFHMO8IP2"),
(23,38,"0461D26FT04MOQW9"),
(24,40,"2321C2H9LOIPV"),
(25,41,"0712E45CDGHKR06"),
(22,36,"3122D09AKIU1R"),
(23,38,"2341F5834LMSVX0"),
(23,38,"0641C18BINR24PUJ"),
(21,35,"2521C29BIJMNQV3"),
(22,36,"0831C3458GHORIKP0"),
(22,36,"0650C18BINR24JLP"),
(21,35,"2331D0A1FQ8RXI"),
(21,35,"1540C423EFJ0QVX"),
(21,35,"2413C4F0BETM17U"),
(21,35,"0622C345EHIQS6X"),
(21,35,"2351C4I5EHLQSVX0"),
(24,40,"1541D02FJQT4MRU9"),
(21,35,"1513DH26FIPJ39Q"),
(23,38,"1351D92JSAMQUW3"),
(24,40,"2521C4F058ITMP1"),
(22,36,"1460D69GJQ02AKRU"),
(24,40,"0451D2CFS6MOQU3"),
(23,38,"1432DL26GI3JS9U"),
(23,38,"2531D465HJQRSUYK"),
(24,40,"2232EAD3QKUX06"),
(23,38,"2441C58FIMR029PU"),
(24,40,"1613C40BEINRL17U"),
(22,36,"3231E14IKTRVXL"),
(22,36,"3431E0AN37KP4IRW"),
(24,40,"1352C53EOIQSWY06"),
(22,36,"0541C35EFO0IPR6"),
(21,35,"2521E1A36BKO4IR"),
(24,40,"2350C2F5HO0ISVX"),
(21,35,"1223C83SAP0LV"),
(21,35,"1531D926BNPQWY3"),
(25,41,"0741C35AEHIS7LPU0"),
(24,40,"1560DF56IKS028MUW"),
(24,40,"2540C2534FOP0QWY"),
(21,35,"2421CGH38IJAQ0"),
(23,38,"3360FBCD8MR146KUY"),
(25,41,"2540D46235FJ0QUW"),
(22,36,"2341E1B2GQ4SUXI"),
(21,35,"1442CE15HP8IWY2R"),
(22,36,"2232E1ALO8IS2V"),
(23,38,"2341C5E0FP1IMW7"),
(23,38,"2231EAD3QKUX6"),
(22,36,"0542D26FMN0IOQ9U"),
(22,36,"1432CE35HOIVX0R"),
(24,40,"2540CBJ03EQR47LY"),
(23,38,"3241CFGH0813JUO"),
(25,41,"1640C25FHMOR39PV"),
(21,35,"1722C201GHIJTAU3Q"),
(22,36,"0661C08GHJT24AKUWQ"),
(22,36,"1631C458HKOPLWY0"),
(23,38,"2451E4C5DHK68RUW0"),
(22,36,"1550DA6BFIQ08JRU"),
(22,36,"2550E0527GLS3IOUW"),
(22,36,"2431DAB29JQKUX3"),
(21,35,"2550F1B0ELOQ248IS"),
(21,35,"1432CH0FGSOQU8I"),
(21,35,"1640DB23AKPR4ILY"),
(22,36,"2441CHJ09AE137YQ"),
(21,35,"0742C1ABFMNO248XIP"),
(22,36,"2441F2B467LPSVXI"),
(21,35,"0631C18BINR24PJ"),
(21,35,"1442C345EO0IPR6V"),
(21,35,"2441D4B6IKR08LSU"),
(24,40,"0641C345EFO0IPR6"),
(21,35,"2570FBD8CKOR146LSVY"),
(24,40,"1422C4BENRLV7O"),
(25,41,"3360E01BGLQ248JSU"),
(23,38,"3331E01A5HKIRU2"),
(23,38,"3240E1ABKLISVX"),
(23,38,"1360CB1GR24IKSU"),
(23,38,"0551C34EFO0IPRV6"),
(21,35,"2341E1A0LO38ISV"),
(21,35,"0751C01BEIJS24MQU8"),
(23,38,"1632CH3EFGOSAIQ0V"),
(24,40,"1730DK14569HR2IL"),
(25,41,"2531F013BMNQ4OYI"),
(21,35,"0633C08GHJT24K9QU"),
(22,36,"0712C158HIQRS2J"),
(22,36,"1550C2159HI3JLPU"),
(25,41,"1451C8HIST1ALUWP"),
(23,38,"1531D356KPSILW0"),
(23,38,"1441CG019Q24AXJ"),
(22,36,"2450E4D3CKO06RVX"),
(21,35,"1532DB2ACMR6UY3J"),
(21,35,"1560D5269IJ3KMQUW"),
(23,38,"1623DB26AFOPWY3IQ"),
(21,35,"2241CAL0Q1JSU7"),
(21,35,"2531CIN18FGK29RV"),
(22,36,"2241E0A3K4IUWR"),
(21,35,"2441D0H1FGKIRVX9"),
(24,40,"1631DA156HOQIKY2"),
(21,35,"2351E0BDGR79KSU1"),
(22,36,"0722C023BEGN4IOU"),
(22,36,"0551C09ENS13ILUO"),
(25,41,"2351C2N9GJ3AKUWQ"),
(23,38,"2423E0B37GQ14IRX"),
(22,36,"2512D453CFKOM0V"),
(24,40,"3351C4IJ9EH02LWY6"),
(23,38,"1451CH02ER4ALVYO"),
(23,38,"0551C38HKPALSWY0"),
(23,38,"2431D0A15HK8IR2"),
(21,35,"2512C3458HIKS0V"),
(21,35,"3420DAKN69LPIX"),
(24,40,"1422DA36KPIR0W"),
(24,40,"1441DK469T02OUL"),
(22,36,"2461C580FOP139MWYQ"),
(21,35,"2350F1BELQ48ISU"),
(21,35,"2620CEI145FHR8V"),
(22,36,"2350E1BGKR24ISU"),
(21,35,"2541F1MEHORT8AIV3"),
(24,40,"1412C40EFIM7P"),
(21,35,"1471E1BKNO24ILRWY8"),
(22,36,"1251DG6Q09IKOX"),
(21,35,"1513DB26AFOY3IP"),
(21,35,"1603E4567HJK0RW"),
(22,36,"1640DK136FOT4MRX"),
(25,41,"0731D3BCFKNO46RV"),
(23,38,"1522FE567HRIS8U"),
(21,35,"2450E6B7GJR09KSU"),
(21,35,"3330D45926K0MR"),
(22,36,"2431C5849IL02PU"),
(23,38,"2621DAJ269HIQKX3"),
(21,35,"1460C89INR1ALPUY"),
(21,35,"2441CAJ03BQ147KX"),
(23,38,"4260E45CDLQ168SUX"),
(22,36,"0532D25HLP09SIX"),
(23,38,"3411C9BI8APQJX"),
(21,35,"2350E1ACLO3JSVX"),
(21,35,"1732C901458IT2JMQU"),
(21,35,"1441DA29OR6IKV3"),
(23,38,"0670C1EHLOT248AIPV"),
(21,35,"2531F1638BNS4JLU"),
(25,41,"1461CA03BQ147IKUR"),
(24,40,"0731C3458HIK6SV0"),
(22,36,"1712D43BCFKOTM0V"),
(21,35,"0760E267GHKT0AIRUW"),
(21,35,"1612C209HIMTA3P"),
(23,38,"1622DK36FGOPAR0X"),
(23,38,"1541C408IJT1KMUQ"),
(23,38,"0660D169HIQ24AJLR"),
(22,36,"3241E01ABLISUW2"),
(21,35,"2251FBE7R08ILSU"),
(21,35,"1371F5ELO02IMPVX6"),
(25,41,"2432E0A37HQ4UXIR"),
(21,35,"2612C4J35EHOQY06"),
(23,38,"3351D0ANFKP137IRW"),
(21,35,"1442D63FGQAJOR0X"),
(24,40,"2441DAH03FQ4RUXI"),
(23,38,"0731C458HKOPISW0"),
(25,41,"1531C9ABEIS7MQ1"),
(23,38,"1431C908HT24AP"),
(23,38,"1442CL08HI13JS9U"),
(24,40,"2331EAD3CQKUX6"),
(23,38,"0731E4567GHKRUW0"),
(22,36,"0462C8FKTIMORUW09"),
(25,41,"0660F378HKL1AISVX"),
(22,36,"2151C2HG4APVXI"),
(22,36,"2412DAB69LQX1I"),
(22,36,"1640C50149GL2IUW"),
(22,36,"2341E1ABLO38ISV"),
(24,40,"1441DH26FM0IOQ9"),
(24,40,"1431DG29JNAKQ3"),
(23,38,"1531CG08BLN249O"),
(23,38,"2521E0L457HQ1SI"),
(24,40,"0732C012EHMT4AIOU"),
(22,36,"3241E15A0K3IVXR"),
(21,35,"2251E0A3Q147IUR"),
(24,40,"1461DA3FHQ147RUXI"),
(21,35,"2250D0A1K3IRUW"),
(23,38,"1632FH4CDEOP0WY6Q"),
(22,36,"1360D9JKT1AMRUW"),
(21,35,"2350D0A1BK8IRUW"),
(21,35,"1550D946IKS02MUW"),
(23,38,"3241E01ABQ24IUR"),
(23,38,"0641C145EFQ28IUR"),
(21,35,"1621C2159HIR3YJ"),
(23,38,"1750FD23CEHOT46QVX"),
(23,38,"0832C023ABEPT4IMQW"),
(22,36,"0641C0EHIMT248AP"),
(23,38,"1542DF2ABCT6MUW3O"),
(24,40,"1522CI19HQTAR3J"),
(25,41,"1541EB367LQ0SUXI"),
(21,35,"2341F2B47LPSVXI"),
(22,36,"1441D526FR9MUYO"),
(24,40,"1532C21GHJTAVX3Q"),
(21,35,"1712C80459LOSM1V"),
(22,36,"1532CN089IJAQU1K"),
(22,36,"2332CAF0HQ8SU1I"),
(21,35,"1461E54COR0268PSK"),
(21,35,"2141D0AKIRUW2"),
(22,36,"2441DAB6IQR0SUYJ"),
(23,38,"3351C45JEFO68MWY0"),
(23,38,"1461CF05EM1379IUO"),
(24,40,"1531CH089LM13AO"),
(22,36,"1333CF05E79I1OU"),
(24,40,"1522DB029CRJL3U"),
(24,40,"0542C35EHOIQSV06"),
(22,36,"1541DA26BOP3QWYI"),
(21,35,"1460E52ADR06KPSV"),
(22,36,"1531CB0148K2ILR"),
(25,41,"0641D45GHKP0RWY6"),
(21,35,"0641C3458KOILRV0"),
(25,41,"2431C581FOSIMV2"),
(23,38,"2550E1B0AKLO3ISVX"),
(22,36,"1542DK1BFGN24IR8X"),
(21,35,"0533C58FHO9WY0IR"),
(22,36,"2322C4F05E8M1O"),
(21,35,"2440E0A7BKLISUW"),
(23,38,"2412E0H27GS9OU"),
(21,35,"1260CB1R24IKSU"),
(22,36,"2541CBE4IJRS027LU"),
(21,35,"0732C3ABEMOT0IQ6W"),
(24,40,"2432DAB26OP3IKQW"),
(21,35,"1631C8034FOT1IMV"),
(21,35,"3240D59G2P03QW"),
(21,35,"0741C18BFKOT2IMRV"),
(21,35,"1451C4BEIR0LPVY6"),
(21,35,"1622CI12EHMT4APV"),
(24,40,"1413C53EIRP0LU"),
(21,35,"1332CF08SMUW1O"),
(23,38,"1351CF0ET79IMUO"),
(23,38,"2442D0H1FGKIRVX39"),
(22,36,"0722C012EHMTAIOU"),
(22,36,"1622F0578HLQ1SIX"),
(22,36,"2560F5D0CELQ137SUX"),
(21,35,"1522D92HKOT6I3V"),
(22,36,"2422C5E34FS7M0V"),
(22,36,"2450E1B0KLO8ISVX"),
(24,40,"1460DBGJQR179KSU"),
(23,38,"0641C038GJQ1AKUR"),
(21,35,"2313D0A5HKI2RU"),
(21,35,"1550C803FIS1AMQU"),
(24,40,"2441C4B8JKR026LU"),
(24,40,"2521C3N048GK1IU"),
(25,41,"2261C5I8F9JMPRW0"),
(21,35,"3430E1AB0CLQJUX"),
(22,36,"2441F0M3BEN47UWO"),
(23,38,"3422E1AB36KO4IRV"),
(21,35,"2421D0N2GKS3IU"),
(25,41,"2730D5K146FGOR2IY"),
(22,36,"2531C2L1BMNO9PY3"),
(22,36,"2171F2BL0469SVXI"),
(21,35,"1630DK1459GR2IY"),
(21,35,"1631C5348FOSIMQ0"),
(24,40,"1560EK037HT1AIOUX"),
(21,35,"2370C9I5PS026JMQW"),
(22,36,"1631D46HIJQR0UYK"),
(21,35,"1650EB267APR0JLSY"),
(21,35,"3231E01ABKIVXR"),
(25,41,"2441E0B23GR4IKSU"),
(22,36,"2261D362H04AOUWJ"),
(22,36,"2403F0B47LQ1IX"),
(21,35,"2432C4B09ER27LOU"),
(21,35,"3332C5AJ09Q13KRX"),
(22,36,"0831C023ABEPT4IMQ"),
(21,35,"1532DA015CQJUX2R"),
(21,35,"2241E1BGL24ISV"),
(24,40,"1541C83FISTAMQU0"),
(25,41,"2531DAH36FOQ4RXI"),
(25,41,"2441D0B2AKR4ILSU"),
(21,35,"1721DA136FHOQ4RI"),
(21,35,"1541CI3458HJLVY0"),
(26,43,"0741D26BFIJS9MQU3"),
(29,48,"0811C04589GHLS1"),
(30,50,"1622C30458GH1UJO"),
(30,50,"1522C5049ELIS1U"),
(27,45,"2621C9I158AQTMX2"),
(26,43,"1422EH27AM3JOU"),
(26,43,"1622E027BGNS39OU"),
(29,48,"2370E0ABKL137ISVX"),
(27,45,"0741D45CGHKP6RWY0"),
(27,45,"1640DK156FIT28MR"),
(26,43,"0670F023EHT4ALOQUW"),
(27,45,"1531CF045EGSVX7"),
(29,48,"1560CA01HQR24IKSU"),
(26,43,"1750EA67HIJQR08KSU"),
(26,43,"1432E567LQ08SIX"),
(27,45,"2511D0G29BJNQ3"),
(27,45,"0741F4578HLQ1SUXI"),
(27,45,"2550E1B02GKL4ISVX"),
(28,46,"3261E01BGL24ISUW8"),
(27,45,"4241EABCD3Q6KUX0"),
(30,50,"2560C8L1BMNO249PVY"),
(27,45,"2421C3H8GISAWP"),
(27,45,"1631D46FIJKT8MR0"),
(29,48,"2431E6G37QT4AXJ"),
(30,50,"1432C92EJTAMQ3U"),
(29,48,"1441C509EL7SUW1"),
(30,50,"2241DAC2R36UYJ"),
(29,48,"2431C2B19IRPUYJ"),
(26,43,"2261C8HIS02ALUWP"),
(27,45,"2361E1B0CL24JSUW8"),
(28,46,"2512C5I348GRY0J"),
(28,46,"2431C450EFR2SY7"),
(28,46,"1650CI25EHJR6LSVY"),
(27,45,"0631E27BGNS39JO"),
(26,43,"2314C4FBETM17OU"),
(26,43,"0713D45CGHKPR06W"),
(26,43,"0712C3458IJKR0L"),
(26,43,"1532C805HRSILV1O"),
(27,45,"0760E03DGHQT1AKOUX"),
(28,46,"1451CI5EHR02LSV7"),
(26,43,"2441CFG08BN24JUO"),
(29,48,"3251DBCKJR68LSU3"),
(26,43,"2460D0A1FKN248IRU"),
(26,43,"2421D092BJNQU3"),
(28,46,"2370CBE01R248ILSV"),
(27,45,"3160E1ANK24IRVX"),
(27,45,"1650D4235HKP0LSWY"),
(27,45,"0631D45CGJQKRX6"),
(26,43,"2441C594EIS7MQU1"),
(26,43,"0642C08FJKTMRUW19"),
(26,43,"2432CGJ0BEN14Q8X"),
(30,50,"1532EH267GS39JOU"),
# "1111C3OXQ",
# "0442DFGHO14ASIP"
)

def l2n(l):
    n = ord(l)
    if n <= 0x39: return n-0x30
    return n-0x41+10
def n2l(n):
    return "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[n]

class Block(object):
    BLOCK_ID = 0
    def __init__(self, b, s):
        Block.BLOCK_ID += 1
        self.board = b
        self.hov = s > 0
        self.size = abs(s)
        self.id = Block.BLOCK_ID
        self.pos = -1
        self.x = self.y = -1
    def put(self, pos):
        ox,oy = x,y = self.board.p2xy(pos)
        for _ in xrange(self.size):
            if self.board.isOut(x,y) or self.board.data[x][y]:
                print "something wrong at %d,%d put(_%d)"%(x,y,pos)
                exit(0)
            self.board.data[x][y] = self.id
            if self.hov: x+=1 
            else: y+=1
        self.x, self.y, self.pos = ox, oy, pos
    def putxy(self, x,y):
        ox,oy = x,y 
        for _ in xrange(self.size):
            if self.board.isOut(x,y) or self.board.data[x][y]:
                print "something wrong at %d,%d putxy(_)"%(x,y)
                exit(0)
            self.board.data[x][y] = self.id
            if self.hov: x+=1 
            else: y+=1
        self.x, self.y, self.pos = ox, oy, self.board.xy2p(ox,oy)
    def tup(self):
        x,y = self.x, self.y
        for _ in xrange(self.size):
            if self.board.isOut(x,y) or self.board.data[x][y] != self.id:
                print "something wrong at %d,%d tup(_%d)"%(x,y)
                exit(0)
            self.board.data[x][y] = 0
            if self.hov: x+=1 
            else: y+=1
        self.x = self.y = self.pos = -1
    def ismovelegal(self, plus):
        mx,my = x,y = ox,oy = self.x, self.y
        if plus > 0:
            sign = 1
            if self.hov:
                x += self.size
            else:
                y += self.size
        else:
            sign= -1
            if self.hov:
                x -= 1
            else:
                y -= 1
        if self.hov:
            mx = x+plus-(1 if sign>1 else 0)
            if self.board.isOut(mx,my) or self.board.data[mx][my]: return -1  
            while x != mx: 
                if self.board.isOut(x,y) or self.board.data[x][y]: return -1
                x += sign
            if sign > 0: mx -= self.size-1
        else:
            my = y+plus-(1 if sign>1 else 0)
            if self.board.isOut(mx,my) or self.board.data[mx][my]: return -1  
            while y != my: 
                if self.board.isOut(x,y) or self.board.data[x][y]: return -1
                y += sign
            if sign > 0: my -= self.size-1
#         self.tup()    
#         self.putxy(mx, my)
        return self.board.xy2p(mx, my)
    def move(self, pos):
        x,y,np = self.x,self.y, self.pos
        self.tup()   
        if self.hov:
            x = x-1
        self.put(pos)        
    def moveable(self, plus):
        mx,my = self.x, self.y
        if plus:
            if self.hov: mx+=self.size
            else: my+=self.size
        else:
            if self.hov: mx-=1
            else: my-=1
        return not (self.board.isOut(mx,my) or self.board.data[mx][my])
    def ismoveable(self):
        mx,my = nx,ny = self.x, self.y
        if self.hov: 
            mx+=self.size
            nx-=1
        else: 
            my+=self.size
            ny-=1
        return (not (self.board.isOut(mx,my) or self.board.data[mx][my])) or \
            (not (self.board.isOut(nx,ny) or self.board.data[nx][ny])) 
    
class Board(object):
    def __init__(self):
        Block.BLOCK_ID = 0
        self.data = [[0]*6 for _ in xrange(6)]
        self.blocks=[]
    def setContentWithTuple(self, arr):
        Block.BLOCK_ID = 0
        arr = [arr[0]] + sorted(arr[1:], key=lambda x:x[1])
        for e in arr:
            blk = Block(self, e[1])
            self.blocks.append(blk)
            blk.put(e[0])   
    def setCheckpoint(self, lv):
        if 0<=lv<len(Digests):
            self.setDigest(Digests[lv][2])
    def setDigest(self, digest):
        Block.BLOCK_ID = 0
        cnt, k, arr = [0]*4, 0, (-3,-2,2,3)
        for i in xrange(4):
            cnt[i]= l2n(digest[i])
        blk = Block(self, 2)
        self.blocks.append(blk)
        blk.put(l2n(digest[4]))
        for e in digest[5:]:
            while cnt[k] == 0:
                k += 1
                if k >= 4:
                    print "something wrong!"
                    exit()
            cnt[k] -= 1
            blk = Block(self, arr[k])
            self.blocks.append(blk)
            blk.put(l2n(e))
    def p2xy(self, pos):
        return pos%6, pos/6
    def xy2p(self, x,y):
        return y*6+x
    def isOut(self,x,y):
        return x<0 or x>=6 or y<0 or y>=6 
    def __repr__(self):
        strbuf= '┌────────────┐\n'
        for y in xrange(6):
            line1 = line2 ='│'
            for x in xrange(6):
                if self.data[x][y]:
                    lkflag = [0]*4
                    lkflag[0] = (x > 0 and self.data[x][y] == self.data[x-1][y])
                    lkflag[1] = (x < 6-1 and self.data[x][y] == self.data[x+1][y])
                    lkflag[2] = (y > 0 and self.data[x][y] == self.data[x][y-1])
                    lkflag[3] = (y < 6-1 and self.data[x][y] == self.data[x][y+1])
                    
                    if lkflag[2]:
                        line1 += ' ' if lkflag[0] else '│' 
                        line1 += ' ' if lkflag[1] else '│'
                    else:
                        line1 += '─' if lkflag[0] else '┌'
                        line1 += '─' if lkflag[1] else '┐'
                    if lkflag[3]:
                        line2 += ' ' if lkflag[0] else '│' 
                        line2 += ' ' if lkflag[1] else '│'
                    else:
                        line2 += '─' if lkflag[0] else '└'
                        line2 += '─' if lkflag[1] else '┘'
                else:
                    line1+='  '
                    line2+='  '
            
            if y == 1:
                strbuf += line1+'│\n' + line2 + '└\n'
            elif y == 2:
                strbuf += line1+'\n' + line2 + '\n'
            elif y == 3:
                strbuf += line1+'┌\n' + line2 + '│\n'
            else:
                strbuf += line1+'│\n' + line2 + '│\n'
        strbuf += '└────────────┘\n'
        return strbuf
    def hash(self): 
        return ''.join(map(lambda x:n2l(x.pos), self.blocks))
    def digest(self):
        cnt = {-3:0,-2:0,2:0,3:0}
        for b in self.blocks[1:]:
            size = b.size *(1 if b.hov else -1)
            cnt[size] += 1
        strl = ''.join(map(lambda x:"%X"%cnt[x],(-3,-2,2,3)))
        return strl + self.hash() 
    def moveableblock(self):
        res = []
        for b in self.blocks:
            if b.ismoveable():
                res.append(b.id-1)
        return res
    def moveavailable(self):
        res = []
        for b in self.blocks:
            for s in xrange(-3,5):
                if b.ismovelegal(s) < 0: continue
                res.append((b.id-1,s)) 
#                     if not b.move(1-s):
#                         print "fuck"
#                         exit()
        return res
    
visited = set() 
history=[]
def search(bd):
    global visited, history
    if bd.blocks[0].pos == 16:
        print 'puzzle solved!'
        return True

    mvs = bd.moveavailable()
    for m in mvs:
        bd.blocks[m[0]].move(m[1])
        hsh = bd.hash()
        if hsh not in visited:
            visited.add(hsh)
            if search(bd): 
                history.append(m)
                bd.blocks[m[0]].move(1-m[1])
                return True
        bd.blocks[m[0]].move(1-m[1])
    return False

def getConfigs():
    import re
    data = None
    ss = None
    y = 0
    with open('/tmp/data.xml','r') as f:
        for l in f.readlines():
            if l.startswith('<Level '):
                ss = l.split('"')
                y = 0
                data = [[0]*6 for _ in xrange(6)]
            elif l.startswith('</Level>'):
                it = []
                bd = Board()
                for y in xrange(6):
                    for x in xrange(6):
                        if data[x][y] == 1:
                            it.append((bd.xy2p(x, y),2))
                            data[x+1][y] = 0
                        elif data[x][y] == 2:
                            it.append((bd.xy2p(x, y),3))
                            data[x+1][y] = 0
                            data[x+2][y] = 0
                        elif data[x][y] == 4:
                            it.append((bd.xy2p(x, y),-2))
                            data[x][y+1] = 0
                        elif data[x][y] == 5:
                            it.append((bd.xy2p(x, y),-3))
                            data[x][y+1] = 0
                            data[x][y+2] = 0
                        elif data[x][y] == 7:
                            it = [(bd.xy2p(x, y),2)]+it
                            data[x+1][y] = 0
                bd.setContentWithTuple(it)
                data = None
                print '(%s, %s, "%s"),'%(ss[3],ss[5],bd.digest())
            elif data:
                ptn = re.compile('\t<Row>([0-9,]+)</Row>')
                m = ptn.match(l)
                if not m:
                    print l
                    exit()
                k = m.groups()[0].split(',')
                for x in xrange(6):
                    data[x][y] = int(k[x])
                y += 1
                
if __name__ == '__main__':
    bd = Board()
#     bd.setContentWithTuple(init_tuple)
#     bd.setDigest("1111C3OXQ")
    bd.setCheckpoint(34)
    print bd.digest()
    print bd
    
    visited.add(bd.hash())
    search(bd)
    
    print bd
    for m in history[::-1]:
        bd.blocks[m[0]].move(m[1])
        print bd